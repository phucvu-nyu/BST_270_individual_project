<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Phuc Vu">

<title>BST 270: Individual Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="candy_rank_files/libs/clipboard/clipboard.min.js"></script>
<script src="candy_rank_files/libs/quarto-html/quarto.js"></script>
<script src="candy_rank_files/libs/quarto-html/popper.min.js"></script>
<script src="candy_rank_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="candy_rank_files/libs/quarto-html/anchor.min.js"></script>
<link href="candy_rank_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="candy_rank_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="candy_rank_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="candy_rank_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="candy_rank_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">BST 270: Individual Project</h1>
<p class="subtitle lead">Reproducible Data Science: Candy Rank (FiveThirtyEight)</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Phuc Vu </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>This notebook is my individual project of BST 270: Reproducible Data Science, taken Winter 2025.</p>
<section id="motivations-and-reproducibility" class="level3">
<h3 class="anchored" data-anchor-id="motivations-and-reproducibility">Motivations and Reproducibility</h3>
<p>My goal is to reproduce two tables from FiveThirtyEight’s <a href="https://fivethirtyeight.com/videos/the-ultimate-halloween-candy-power-ranking/">The Ultimate Halloween Candy Power Ranking</a>.</p>
<p>Specifically, I aim to reproduce the two tables provided on the ranking and the importance of components of candies when they compete again each other for the best candy title. The data used for this notebook is the results of 269,000 randomly generated matchups from 8,371 different IP addresses to decide which candy do people love. The data is stored at <code>../data/candy-data.csv</code>.</p>
</section>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<p>The requried libraries for this notebooks are formattable and htmltools. We then downloaded and saved the data from FiveThirtyEight’s official GitHub repository: <a href="https://github.com/fivethirtyeight/data/blob/master/candy-power-ranking">fivethirtyeight/data/candy-power-ranking</a> at <code>../data/candy-data.csv</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if the environment has the required libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"formattable"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"formattable"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"htmltools"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"htmltools"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"tidyverse"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading necessary libraries</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(formattable)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmltools)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the url of the candy data</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/fivethirtyeight/data/master/candy-power-ranking/candy-data.csv"</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># read in the candy data</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>candy_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># store the candy data in the data folwer</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(candy_data, <span class="at">file=</span><span class="st">'../data/candy-data.csv'</span>, <span class="at">quote=</span><span class="cn">FALSE</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reproducing-tables" class="level2">
<h2 class="anchored" data-anchor-id="reproducing-tables">Reproducing Tables</h2>
<section id="table-1-how-often-did-a-fun-sized-candy-of-a-given-type-win-its-matchups-against-the-rest-of-the-field" class="level3">
<h3 class="anchored" data-anchor-id="table-1-how-often-did-a-fun-sized-candy-of-a-given-type-win-its-matchups-against-the-rest-of-the-field">Table 1: How often did a fun-sized candy of a given type win its matchups against the rest of the field?</h3>
<p>The first table demonstrates the winning rate of a candy against the other candies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>table_1<span class="ot">&lt;-</span>candy_data<span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">RK=</span><span class="fu">rank</span>(<span class="sc">-</span>winpercent), <span class="co"># use winpercent as ranking, with highest winpercent to be rank 1</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">winpercent=</span><span class="fu">round</span>(winpercent,<span class="dv">1</span>))<span class="sc">|&gt;</span> <span class="co"># round up the winpercent for aesthetic</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(RK,competitorname,winpercent)<span class="sc">|&gt;</span> <span class="co"># select only 3 columns to recreate the table</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(winpercent))<span class="sc">|&gt;</span><span class="co"># rearrange the rows from the highest to lowest win percent</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">CANDY=</span>competitorname,<span class="st">`</span><span class="at">WIN PERCENT</span><span class="st">`</span><span class="ot">=</span>winpercent)<span class="sc">|&gt;</span> <span class="co"># rename the columns to match the table</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># in the original article</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>           <span class="fu">formattable</span>(<span class="fu">list</span>( <span class="co"># use formattable to add the color bar based on the winpercent</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>             <span class="st">`</span><span class="at">WIN PERCENT</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">formatter</span>(<span class="st">"span"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">style =</span> x <span class="sc">~</span> <span class="fu">style</span>(</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">display =</span> <span class="st">"flex"</span>,  <span class="co"># Use flex layout for alignment</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"align-items"</span> <span class="ot">=</span> <span class="st">"center"</span>,         <span class="co"># Align percentage and bar vertically</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"gap"</span> <span class="ot">=</span> <span class="st">"10px"</span>                    <span class="co"># Add spacing between number and bar</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">~</span> <span class="fu">paste0</span>(</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">'&lt;span style="display:inline-block; text-align:left; width:35px;"&gt;'</span>, x, <span class="st">'%&lt;/span&gt;'</span>,  <span class="co"># Add percentage value after the number </span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">'&lt;span style="display:inline-block; width:'</span>, x <span class="sc">*</span> <span class="fl">1.5</span>, <span class="st">'px; height:10px; background-color:orange;"&gt;&lt;/span&gt;'</span>  <span class="co"># add the color bar that has width = 1.5* percent win</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"l"</span>, <span class="st">"l"</span>) <span class="co"># change alignment of the three columns to all left aligned</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Please not that formattable will interpret “&lt;” as “&lt;” and “&gt;” as “&gt;” in the “x~paste0(…)” part. Therefore, we need to change these values manually in the raw html table before we can show them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Render the table </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>raw_html<span class="ot">&lt;-</span><span class="fu">as.character</span>(table_1) <span class="co"># extract the raw html table</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>raw_html <span class="ot">&lt;-</span> <span class="fu">gsub</span>( <span class="st">"&amp;lt;"</span>,<span class="st">"&lt;"</span>, raw_html)    <span class="co"># Escape '&lt;'</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>raw_html <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"&amp;gt;"</span>,<span class="st">"&gt;"</span>, raw_html)    <span class="co"># Escape '&gt;'</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">browsable</span>(<span class="fu">HTML</span>(raw_html)) <span class="co"># Display the table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-condensed caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">RK</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">CANDY</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">WIN PERCENT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Reese's Peanut Butter cup</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">84.2%</span><span style="display:inline-block; width:126.3px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Reese's Miniatures</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">81.9%</span><span style="display:inline-block; width:122.85px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Twix</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">81.6%</span><span style="display:inline-block; width:122.4px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">Kit Kat</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">76.8%</span><span style="display:inline-block; width:115.2px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">Snickers</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">76.7%</span><span style="display:inline-block; width:115.05px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">Reese's pieces</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">73.4%</span><span style="display:inline-block; width:110.1px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">Milky Way</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">73.1%</span><span style="display:inline-block; width:109.65px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">Reese's stuffed with pieces</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">72.9%</span><span style="display:inline-block; width:109.35px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: left;">Peanut butter M&amp;M's</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">71.5%</span><span style="display:inline-block; width:107.25px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">Nestle Butterfinger</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">70.7%</span><span style="display:inline-block; width:106.05px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">11</td>
<td style="text-align: left;">Peanut M&amp;Ms</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">69.5%</span><span style="display:inline-block; width:104.25px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">12</td>
<td style="text-align: left;">3 Musketeers</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">67.6%</span><span style="display:inline-block; width:101.4px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">14</td>
<td style="text-align: left;">100 Grand</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">67%</span><span style="display:inline-block; width:100.5px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">13</td>
<td style="text-align: left;">Starburst</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">67%</span><span style="display:inline-block; width:100.5px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">15</td>
<td style="text-align: left;">M&amp;M's</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">66.6%</span><span style="display:inline-block; width:99.9px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">16</td>
<td style="text-align: left;">Nestle Crunch</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">66.5%</span><span style="display:inline-block; width:99.75px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">17</td>
<td style="text-align: left;">Rolo</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">65.7%</span><span style="display:inline-block; width:98.55px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">18</td>
<td style="text-align: left;">Milky Way Simply Caramel</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">64.4%</span><span style="display:inline-block; width:96.6px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">19</td>
<td style="text-align: left;">Skittles original</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">63.1%</span><span style="display:inline-block; width:94.65px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">20</td>
<td style="text-align: left;">Hershey's Krackel</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">62.3%</span><span style="display:inline-block; width:93.45px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">21</td>
<td style="text-align: left;">Milky Way Midnight</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">60.8%</span><span style="display:inline-block; width:91.2px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">22</td>
<td style="text-align: left;">Sour Patch Kids</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">59.9%</span><span style="display:inline-block; width:89.85px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">23</td>
<td style="text-align: left;">Snickers Crisper</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">59.5%</span><span style="display:inline-block; width:89.25px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">24</td>
<td style="text-align: left;">Hershey's Special Dark</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">59.2%</span><span style="display:inline-block; width:88.8px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">25</td>
<td style="text-align: left;">Junior Mints</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">57.2%</span><span style="display:inline-block; width:85.8px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">26</td>
<td style="text-align: left;">Haribo Gold Bears</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">57.1%</span><span style="display:inline-block; width:85.65px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">27</td>
<td style="text-align: left;">Baby Ruth</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">56.9%</span><span style="display:inline-block; width:85.35px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">28</td>
<td style="text-align: left;">Hershey's Milk Chocolate</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">56.5%</span><span style="display:inline-block; width:84.75px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">29</td>
<td style="text-align: left;">Hershey's Kisses</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">55.4%</span><span style="display:inline-block; width:83.1px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">30</td>
<td style="text-align: left;">Nerds</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">55.4%</span><span style="display:inline-block; width:83.1px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">32</td>
<td style="text-align: left;">Milk Duds</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">55.1%</span><span style="display:inline-block; width:82.65px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">31</td>
<td style="text-align: left;">Skittles wildberry</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">55.1%</span><span style="display:inline-block; width:82.65px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">33</td>
<td style="text-align: left;">Swedish Fish</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">54.9%</span><span style="display:inline-block; width:82.35px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">34</td>
<td style="text-align: left;">Mr Good Bar</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">54.5%</span><span style="display:inline-block; width:81.75px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">35</td>
<td style="text-align: left;">Lifesavers big ring gummies</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">52.9%</span><span style="display:inline-block; width:79.35px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">36</td>
<td style="text-align: left;">Sour Patch Tricksters</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">52.8%</span><span style="display:inline-block; width:79.2px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">37</td>
<td style="text-align: left;">Air Heads</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">52.3%</span><span style="display:inline-block; width:78.45px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">38</td>
<td style="text-align: left;">Haribo Sour Bears</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">51.4%</span><span style="display:inline-block; width:77.1px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">39</td>
<td style="text-align: left;">Almond Joy</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">50.3%</span><span style="display:inline-block; width:75.45px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">40</td>
<td style="text-align: left;">Tootsie Roll Snack Bars</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">49.7%</span><span style="display:inline-block; width:74.55px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">41</td>
<td style="text-align: left;">Whoppers</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">49.5%</span><span style="display:inline-block; width:74.25px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">42</td>
<td style="text-align: left;">Tootsie Pop</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">49%</span><span style="display:inline-block; width:73.5px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">43</td>
<td style="text-align: left;">Mounds</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">47.8%</span><span style="display:inline-block; width:71.7px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">44</td>
<td style="text-align: left;">Trolli Sour Bites</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">47.2%</span><span style="display:inline-block; width:70.8px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">45</td>
<td style="text-align: left;">Gobstopper</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">46.8%</span><span style="display:inline-block; width:70.2px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">46</td>
<td style="text-align: left;">Mike &amp; Ike</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">46.4%</span><span style="display:inline-block; width:69.6px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">47</td>
<td style="text-align: left;">Payday</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">46.3%</span><span style="display:inline-block; width:69.45px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">48</td>
<td style="text-align: left;">One quarter</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">46.1%</span><span style="display:inline-block; width:69.15px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">49</td>
<td style="text-align: left;">Smarties candy</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">46%</span><span style="display:inline-block; width:69px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">50</td>
<td style="text-align: left;">Tootsie Roll Midgies</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">45.7%</span><span style="display:inline-block; width:68.55px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">51</td>
<td style="text-align: left;">Twizzlers</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">45.5%</span><span style="display:inline-block; width:68.25px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">52</td>
<td style="text-align: left;">Welch's Fruit Snacks</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">44.4%</span><span style="display:inline-block; width:66.6px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">53</td>
<td style="text-align: left;">Fruit Chews</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">43.1%</span><span style="display:inline-block; width:64.65px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">54</td>
<td style="text-align: left;">Tootsie Roll Juniors</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">43.1%</span><span style="display:inline-block; width:64.65px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">55</td>
<td style="text-align: left;">Runts</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">42.8%</span><span style="display:inline-block; width:64.2px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">56</td>
<td style="text-align: left;">Dots</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">42.3%</span><span style="display:inline-block; width:63.45px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">57</td>
<td style="text-align: left;">Haribo Twin Snakes</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">42.2%</span><span style="display:inline-block; width:63.3px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">58</td>
<td style="text-align: left;">Werther's Original Caramel</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">41.9%</span><span style="display:inline-block; width:62.85px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">59</td>
<td style="text-align: left;">Laffy Taffy</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">41.4%</span><span style="display:inline-block; width:62.1px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">60</td>
<td style="text-align: left;">Pop Rocks</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">41.3%</span><span style="display:inline-block; width:61.95px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">61</td>
<td style="text-align: left;">Dum Dums</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">39.5%</span><span style="display:inline-block; width:59.25px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">62</td>
<td style="text-align: left;">Now &amp; Later</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">39.4%</span><span style="display:inline-block; width:59.1px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">63</td>
<td style="text-align: left;">Fun Dip</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">39.2%</span><span style="display:inline-block; width:58.8px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">64</td>
<td style="text-align: left;">Lemonhead</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">39.1%</span><span style="display:inline-block; width:58.65px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">66</td>
<td style="text-align: left;">Charleston Chew</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">39%</span><span style="display:inline-block; width:58.5px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">65</td>
<td style="text-align: left;">Warheads</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">39%</span><span style="display:inline-block; width:58.5px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">67</td>
<td style="text-align: left;">Candy Corn</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">38%</span><span style="display:inline-block; width:57px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">68</td>
<td style="text-align: left;">Nestle Smarties</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">37.9%</span><span style="display:inline-block; width:56.85px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">69</td>
<td style="text-align: left;">Pixie Sticks</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">37.7%</span><span style="display:inline-block; width:56.55px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">70</td>
<td style="text-align: left;">Red vines</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">37.3%</span><span style="display:inline-block; width:55.95px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">71</td>
<td style="text-align: left;">Chewey Lemonhead Fruit Mix</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">36%</span><span style="display:inline-block; width:54px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">72</td>
<td style="text-align: left;">Ring pop</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">35.3%</span><span style="display:inline-block; width:52.95px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">73</td>
<td style="text-align: left;">Sixlets</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">34.7%</span><span style="display:inline-block; width:52.05px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">74</td>
<td style="text-align: left;">Strawberry bon bons</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">34.6%</span><span style="display:inline-block; width:51.9px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">75</td>
<td style="text-align: left;">Caramel Apple Pops</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">34.5%</span><span style="display:inline-block; width:51.75px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">76</td>
<td style="text-align: left;">Haribo Happy Cola</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">34.2%</span><span style="display:inline-block; width:51.3px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">77</td>
<td style="text-align: left;">Sugar Babies</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">33.4%</span><span style="display:inline-block; width:50.1px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">78</td>
<td style="text-align: left;">One dime</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">32.3%</span><span style="display:inline-block; width:48.45px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">79</td>
<td style="text-align: left;">Sugar Daddy</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">32.2%</span><span style="display:inline-block; width:48.3px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">80</td>
<td style="text-align: left;">Root Beer Barrels</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">29.7%</span><span style="display:inline-block; width:44.55px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">81</td>
<td style="text-align: left;">Jawbusters</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">28.1%</span><span style="display:inline-block; width:42.15px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">82</td>
<td style="text-align: left;">Super Bubble</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">27.3%</span><span style="display:inline-block; width:40.95px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">83</td>
<td style="text-align: left;">Chiclets</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">24.5%</span><span style="display:inline-block; width:36.75px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="even">
<td style="text-align: left;">84</td>
<td style="text-align: left;">Boston Baked Beans</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">23.4%</span><span style="display:inline-block; width:35.1px; height:10px; background-color:orange;"></span></span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">85</td>
<td style="text-align: left;">Nik L Nip</td>
<td style="text-align: left;"><span style="display: flex; align-items: center; gap: 10px"><span style="display:inline-block; text-align:left; width:35px;">22.4%</span><span style="display:inline-block; width:33.6px; height:10px; background-color:orange;"></span></span></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="table-2-how-each-component-affect-the-percentage-to-win-of-a-candy-and-their-average-winning-rate" class="level3">
<h3 class="anchored" data-anchor-id="table-2-how-each-component-affect-the-percentage-to-win-of-a-candy-and-their-average-winning-rate">Table 2: How each component affect the percentage to win of a candy and their average winning rate</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>component_coef<span class="ot">&lt;-</span><span class="fu">lm</span>(winpercent<span class="sc">~</span>chocolate<span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                     fruity<span class="sc">+</span>caramel<span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                     peanutyalmondy<span class="sc">+</span>nougat<span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                     crispedricewafer<span class="sc">+</span>hard<span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                     bar<span class="sc">+</span>pluribus,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data=</span>candy_data)<span class="sc">$</span>coef[<span class="sc">-</span><span class="dv">1</span>] <span class="co"># create the linear regression model </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#and extract its coefficients (minus the intercept)</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>component_coef<span class="ot">&lt;-</span><span class="fu">round</span>(component_coef,<span class="dv">1</span>) <span class="co"># round the coeficients</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>components<span class="ot">&lt;-</span><span class="fu">names</span>(component_coef) <span class="co"># get the names of the columns </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>component_avg<span class="ot">&lt;-</span><span class="fu">sapply</span>(components,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                      <span class="cf">function</span>(x) <span class="fu">mean</span>(candy_data<span class="sc">$</span>winpercent[candy_data[x]<span class="sc">==</span><span class="dv">1</span>])) <span class="co"># used the extracted names to calculate their winning average</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>component_avg<span class="ot">&lt;-</span><span class="fu">round</span>(component_avg,<span class="dv">0</span>)<span class="co"># round the winning average</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># define a normalizing function so that the color reflect the magnitude of</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co"># the value with respect to the max and min value</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>normalize <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> <span class="fu">min</span>(x)) <span class="sc">/</span> (<span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x))</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co"># specify the labels of the variables</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>components<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Chocolate"</span>,<span class="st">"Fruit"</span>,<span class="st">"Caramel"</span>,<span class="st">"Peanuts &amp; nuts"</span>,<span class="st">"Nougat"</span>,<span class="st">"Crispy"</span>,<span class="st">"Hard candy"</span>,<span class="st">"Candy bar"</span>,<span class="st">"Multi-piece"</span>)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the table 2 that has 3 columns</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>table2<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">candytype=</span>components,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>                   <span class="st">`</span><span class="at">avg_win_share</span><span class="st">`</span><span class="ot">=</span>component_avg,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>                   <span class="st">`</span><span class="at">value_add</span><span class="st">`</span><span class="ot">=</span>component_coef)<span class="sc">|&gt;</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(value_add))<span class="sc">|&gt;</span> <span class="co"># arrange based on the value add to winning percent</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">CANDY TYPE</span><span class="st">`</span><span class="ot">=</span>candytype,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">AVG. WIN SHARE %</span><span class="st">`</span><span class="ot">=</span>avg_win_share,</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">VALUE ADD TO WIN %</span><span class="st">`</span><span class="ot">=</span>value_add)<span class="sc">|&gt;</span> <span class="co"># rename to match the column names of the table</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formattable</span>( <span class="fu">list</span>(</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">VALUE ADD TO WIN %</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">formatter</span>(</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"span"</span>,</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> x <span class="sc">~</span> <span class="fu">style</span>(</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">display =</span> <span class="st">"block"</span>,</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">padding =</span> <span class="st">"5px"</span>,</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">background =</span> <span class="fu">ifelse</span>(</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>        x <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rgb</span>(<span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fu">normalize</span>(x)), <span class="co"># Light blue for positive values</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="at">alpha =</span> <span class="fu">normalize</span>(<span class="fu">abs</span>(x))) <span class="co"># Red for negative values</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> <span class="st">"black"</span></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>    x <span class="sc">~</span> <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>,</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>               <span class="fu">paste0</span>(<span class="st">"+"</span>, <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, x)),</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sprintf</span>(<span class="st">"%.1f"</span>, x)) <span class="co"># Add "+" for positive values</span></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>),<span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"r"</span>, <span class="st">"r"</span>)) <span class="co"># specify alignment to match original table</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(table2)<span class="ot">&lt;-</span><span class="cn">NULL</span> <span class="co"># remove rownames of table</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>table2 <span class="co"># display table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-condensed">
<thead>
<tr>
<th style="text-align:left;">
CANDY TYPE
</th>
<th style="text-align:right;">
AVG. WIN SHARE %
</th>
<th style="text-align:right;">
VALUE ADD TO WIN %
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Chocolate
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
<span style="display: block; padding: 5px; background: #99CCFFFF; color: black">+19.9</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Fruit
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
<span style="display: block; padding: 5px; background: #99CCFF9C; color: black">+10.3</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Peanuts &amp; nuts
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
<span style="display: block; padding: 5px; background: #99CCFF9A; color: black">+10.1</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Crispy
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
<span style="display: block; padding: 5px; background: #99CCFF8F; color: black">+9.0</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Caramel
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
<span style="display: block; padding: 5px; background: #99CCFF55; color: black">+3.4</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Nougat
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
<span style="display: block; padding: 5px; background: #99CCFF4B; color: black">+2.4</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Multi-piece
</td>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
<span style="display: block; padding: 5px; background: #FF666600; color: black">-0.2</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Candy bar
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
<span style="display: block; padding: 5px; background: #FF666606; color: black">-0.7</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
Hard candy
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
<span style="display: block; padding: 5px; background: #FF66663D; color: black">-4.9</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The data we downloaded only has 85 rows while the table in the original articles has 86 rows. Particularly, the observation for Good&amp;Plenty is missing. Furthermore, the average winning of Peanuts, Crispy, Nougat, Multi-piece, and Hard candy differ significantly compared to the original table. This suggest that the missing observation of Good&amp;Plenty have these components.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>